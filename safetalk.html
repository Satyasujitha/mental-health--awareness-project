<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SafeTalk Support Chat</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header class="top-header">
  <h1>SafeTalk ğŸ’¬</h1>
  <p>Talk. Share. Feel lighter.</p>
</header>

<nav class="navbar">
  <a href="index.html">Home</a>
  <a href="tips.html">Tips</a>
  <a href="dashboard.html">Dashboard</a>
  <a href="quiz.html">Quiz</a>
</nav>

<section class="card-section">

  <!-- WHY -->
  <div class="card" style="text-align:left;">
    <h2>ğŸ’› Why talking helps</h2>
    <ul>
      <li>You feel understood</li>
      <li>You stop overthinking alone</li>
      <li>Your stress reduces</li>
      <li>Your emotions feel lighter</li>
    </ul>
  </div>

  <!-- WHEN -->
  <div class="card" style="text-align:left;">
    <h2>ğŸ•’ When should you talk?</h2>
    <ul>
      <li>When thoughts feel too heavy</li>
      <li>When you feel ignored</li>
      <li>When anxiety stays for days</li>
      <li>When mood doesnâ€™t lift</li>
    </ul>
  </div>

  <!-- CONTACTS SAVE -->
  <div class="card">
    <h2>ğŸ“ Add Someone You Trust</h2>
    <input type="text" id="name" placeholder="Name" class="input-box">
    <input type="text" id="relation" placeholder="Relation (e.g., cousin, teacher)" class="input-box">
    <input type="number" id="phone" placeholder="Phone Number" class="input-box">
    <button onclick="savePerson()">Save Contact</button>
    <p id="saveMsg"></p>
  </div>

  <!-- SAVED -->
  <div class="card" style="text-align:left;">
    <h2>ğŸ“‹ Saved Trusted Contacts</h2>
    <div id="contactList"></div>
  </div>

</section>

<!-- CHAT SECTION -->
<h2 style="text-align:center;">ğŸ’¬ Share What You Feel</h2>

<div class="chat-container" id="chatBox"></div>

<div class="chat-input-area">
  <input type="text" id="userInput" placeholder="Type how you're feeling..." />
  <button onclick="sendMessage()">Send</button>
</div>

<section class="card-section">
  <div class="card" style="text-align:left;">
    <h2>ğŸš¨ Emergency Helpline</h2>
    <p>1098 - Child Helpline</p>
    <p>112 - National Emergency Number</p>
  </div>
</section>

<div class="back-container">
  <a href="tips.html"><button class="back-btn">â† Back to Tips</button></a>
</div>

<script>
function savePerson() {
  const name = document.getElementById("name").value;
  const relation = document.getElementById("relation").value;
  const phone = document.getElementById("phone").value;

  if(!name || !relation || !phone) {
    alert("Please fill all fields");
    return;
  }

  const data = JSON.parse(localStorage.getItem("trustedPersons")) || [];
  data.push({ name, relation, phone });
  localStorage.setItem("trustedPersons", JSON.stringify(data));
  showContacts();
  document.getElementById("saveMsg").innerText = "âœ” Contact saved!";
  document.getElementById("name").value = "";
  document.getElementById("relation").value = "";
  document.getElementById("phone").value = "";
}

function showContacts() {
  const listDiv = document.getElementById("contactList");
  const data = JSON.parse(localStorage.getItem("trustedPersons")) || [];

  if(data.length === 0) {
    listDiv.innerHTML = "<p>No contacts saved yet.</p>";
    return;
  }

  let html = "<ul>";
  data.forEach((person, index) => {
    html += `<li>${person.name} (${person.relation}) - ${person.phone}
      <button onclick="deletePerson(${index})">Delete</button>
    </li>`;
  });
  html += "</ul>";
  listDiv.innerHTML = html;
}

function deletePerson(index) {
  const data = JSON.parse(localStorage.getItem("trustedPersons")) || [];
  data.splice(index, 1);
  localStorage.setItem("trustedPersons", JSON.stringify(data));
  showContacts();
}

showContacts();

function botReply(text) {
  const bubble = document.createElement("div");
  bubble.classList.add("chat-bubble", "bot");
  bubble.innerText = text;
  chatBox.appendChild(bubble);
  chatBox.scrollTop = chatBox.scrollHeight;
}

function sendMessage() {
  const input = document.getElementById("userInput");
  if (!input.value.trim()) return;

  const bubble = document.createElement("div");
  bubble.classList.add("chat-bubble", "user");
  bubble.innerText = input.value;
  chatBox.appendChild(bubble);

  chatBox.scrollTop = chatBox.scrollHeight;

  let msg = input.value.toLowerCase();
  input.value = "";

  // REPLY LISTS FOR VARIATION
  const sadReplies = [
    "Iâ€™m sorry you're feeling like this ğŸ’› You can talk to me, Iâ€™m listening.",
    "It must be heavy to feel this way. Want to share more?",
    "You donâ€™t have to handle it alone. Iâ€™m here with you.",
    "Your feelings are valid. Iâ€™m here if you want to express more."
  ];

  const angryReplies = [
    "Itâ€™s okay to feel angry sometimes. What caused it?",
    "You deserve space to express this feeling safely.",
    "Anger often hides hurt. What do you think triggered it?",
    "I hear you. When did you start feeling like this?"
  ];

  const anxiousReplies = [
    "Anxiety can feel overwhelming. You are safe here ğŸ’›",
    "Youâ€™re doing your best. Breathing helpsâ€”would you like guidance?",
    "Itâ€™s okay to talk slowly. Iâ€™m here with you.",
    "Youâ€™re not alone in this feeling. Want to share what caused it?"
  ];

  const defaultReplies = [
    "Iâ€™m listening ğŸ‘‚ You can share more if you want.",
    "You donâ€™t have to rush, take your time.",
    "Feel free to express whatâ€™s in your mind.",
    "Itâ€™s okay, Iâ€™m here for you ğŸ’›"
  ];

  setTimeout(() => {
    let reply = "";

    if (msg.includes("sad") || msg.includes("low") || msg.includes("upset")) {
      reply = sadReplies[Math.floor(Math.random() * sadReplies.length)];
    } 
    else if (msg.includes("angry") || msg.includes("frustrated")) {
      reply = angryReplies[Math.floor(Math.random() * angryReplies.length)];
    } 
    else if (msg.includes("scared") || msg.includes("anxious")) {
      reply = anxiousReplies[Math.floor(Math.random() * anxiousReplies.length)];
    } 
    else {
      reply = defaultReplies[Math.floor(Math.random() * defaultReplies.length)];
    }

    botReply(reply);
  }, 800);
}

</script>

</body>
</html>

