<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SafeTalk Support Chat</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header class="top-header">
  <h1>SafeTalk ğŸ’¬</h1>
  <p>Talk. Share. Feel lighter.</p>
</header>

<nav class="navbar">
  <a href="index.html">Home</a>
  <a href="tips.html">Tips</a>
  <a href="dashboard.html">Dashboard</a>
  <a href="quiz.html">Quiz</a>
</nav>

<section class="card-section">

  <!-- WHY -->
  <div class="card" style="text-align:left;">
    <h2>ğŸ’› Why talking helps</h2>
    <ul>
      <li>You feel understood</li>
      <li>You stop overthinking alone</li>
      <li>Your stress reduces</li>
      <li>Your emotions feel lighter</li>
    </ul>
  </div>

  <!-- WHEN -->
  <div class="card" style="text-align:left;">
    <h2>ğŸ•’ When should you talk?</h2>
    <ul>
      <li>When thoughts feel too heavy</li>
      <li>When you feel ignored</li>
      <li>When anxiety stays for days</li>
      <li>When mood doesnâ€™t lift</li>
    </ul>
  </div>

  <!-- CONTACTS SAVE -->
  <div class="card">
    <h2>ğŸ“ Add Someone You Trust</h2>
    <input type="text" id="name" placeholder="Name" class="input-box">
    <input type="text" id="relation" placeholder="Relation (e.g., cousin, teacher)" class="input-box">
    <input type="number" id="phone" placeholder="Phone Number" class="input-box">
    <button onclick="savePerson()">Save Contact</button>
    <p id="saveMsg"></p>
  </div>

  <!-- SAVED -->
  <div class="card" style="text-align:left;">
    <h2>ğŸ“‹ Saved Trusted Contacts</h2>
    <div id="contactList"></div>
  </div>

</section>

<!-- CHAT SECTION -->
<h2 style="text-align:center;">ğŸ’¬ Share What You Feel</h2>

<div class="chat-container" id="chatBox"></div>

<div class="chat-input-area">
  <input type="text" id="userInput" placeholder="Type how you're feeling..." />
  <button onclick="sendMessage()">Send</button>
</div>

<section class="card-section">
  <div class="card" style="text-align:left;">
    <h2>ğŸš¨ Emergency Helpline</h2>
    <p>1098 - Child Helpline</p>
    <p>112 - National Emergency Number</p>
  </div>
</section>

<div class="back-container">
  <a href="tips.html"><button class="back-btn">â† Back to Tips</button></a>
</div>

<script>
function savePerson() {
  const name = document.getElementById("name").value;
  const relation = document.getElementById("relation").value;
  const phone = document.getElementById("phone").value;

  if(!name || !relation || !phone) {
    alert("Please fill all fields");
    return;
  }

  const data = JSON.parse(localStorage.getItem("trustedPersons")) || [];
  data.push({ name, relation, phone });
  localStorage.setItem("trustedPersons", JSON.stringify(data));
  showContacts();
  document.getElementById("saveMsg").innerText = "âœ” Contact saved!";
  document.getElementById("name").value = "";
  document.getElementById("relation").value = "";
  document.getElementById("phone").value = "";
}

function showContacts() {
  const listDiv = document.getElementById("contactList");
  const data = JSON.parse(localStorage.getItem("trustedPersons")) || [];

  if(data.length === 0) {
    listDiv.innerHTML = "<p>No contacts saved yet.</p>";
    return;
  }

  let html = "<ul>";
  data.forEach((person, index) => {
    html += `<li>${person.name} (${person.relation}) - ${person.phone}
      <button onclick="deletePerson(${index})">Delete</button>
    </li>`;
  });
  html += "</ul>";
  listDiv.innerHTML = html;
}

function deletePerson(index) {
  const data = JSON.parse(localStorage.getItem("trustedPersons")) || [];
  data.splice(index, 1);
  localStorage.setItem("trustedPersons", JSON.stringify(data));
  showContacts();
}

showContacts();

function botReply(text) {
  const bubble = document.createElement("div");
  bubble.classList.add("chat-bubble", "bot");
  bubble.innerText = text;
  chatBox.appendChild(bubble);
  chatBox.scrollTop = chatBox.scrollHeight;
}

function sendMessage() {
  const input = document.getElementById("userInput");
  if (!input.value.trim()) return;

  const bubble = document.createElement("div");
  bubble.classList.add("chat-bubble", "user");
  bubble.innerText = input.value;
  chatBox.appendChild(bubble);

  chatBox.scrollTop = chatBox.scrollHeight;

  let msg = input.value.toLowerCase();
  input.value = "";

  setTimeout(() => {
    if (msg.includes("sad") || msg.includes("low") || msg.includes("upset")) {
      botReply("Iâ€™m sorry youâ€™re feeling this way ğŸ’› Iâ€™m here to listen if you want to share more.");
    } 
    else if (msg.includes("angry") || msg.includes("frustrated")) {
      botReply("That sounds tough. What made you feel this way?");
    }
    else if (msg.includes("scared") || msg.includes("anxious")) {
      botReply("Anxiety can feel heavy. Youâ€™re safe here. Want to talk more?");
    }
    else {
      botReply("Iâ€™m listening ğŸ‘‚ You can tell me more if you'd like.");
    }
  }, 700);
}
</script>

</body>
</html>
